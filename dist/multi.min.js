/*! multi.js 08-04-2021 */

var multi=function(){var e=function(e,t){var a=t.limit;if(a>-1){for(var n=0,i=0;i<e.options.length;i++)e.options[i].selected&&n++;if(n===a){this.disabled_limit=!0,"function"==typeof t.limit_reached&&t.limit_reached();for(i=0;i<e.options.length;i++){(r=e.options[i]).selected||r.setAttribute("disabled",!0)}}else if(this.disabled_limit){for(i=0;i<e.options.length;i++){var r;"false"===(r=e.options[i]).getAttribute("data-origin-disabled")&&r.removeAttribute("disabled")}this.disabled_limit=!1}}},t=function(t,a,n){var i,r,d,l=t.options[a.target.getAttribute("multi-index")];l.disabled||(l.selected=!l.selected,e(t,n),i="change",r=t,(d=document.createEvent("HTMLEvents")).initEvent(i,!1,!0),r.dispatchEvent(d))},a=function(e,t){if(e.wrapper.selected.innerHTML="",e.wrapper.non_selected.innerHTML="",t.non_selected_header&&t.selected_header){var a=document.createElement("div"),n=document.createElement("div");a.className="header",n.className="header",a.innerText=t.non_selected_header,n.innerText=t.selected_header,e.wrapper.non_selected.appendChild(a),e.wrapper.selected.appendChild(n)}if(e.wrapper.search)var i=e.wrapper.search.value;for(var r=null,d=null,l=0;l<e.options.length;l++){var s=e.options[l],o=s.value,c=s.textContent||s.innerText,p=s.getAttribute("data-search"),u=document.createElement("a");if(u.tabIndex=0,u.className="item",u.innerText=c,u.setAttribute("role","button"),u.setAttribute("data-value",o),u.setAttribute("multi-index",l),p&&u.setAttribute("data-search",p),s.disabled&&(u.className+=" disabled"),s.selected){u.className+=" selected";var m=u.cloneNode(!0);e.wrapper.selected.appendChild(m)}if("OPTGROUP"==s.parentNode.nodeName&&s.parentNode!=d){if(d=s.parentNode,(r=document.createElement("div")).className="item-group",s.parentNode.label){var h=document.createElement("span");h.innerHTML=s.parentNode.label,h.className="group-label",r.appendChild(h)}e.wrapper.non_selected.appendChild(r)}s.parentNode==e&&(r=null,d=null),(!i||i&&c.toLowerCase().indexOf(i.toLowerCase())>-1||i&&p&&p.toLowerCase().indexOf(i.toLowerCase())>-1||t.search_multiple_words&&i&&i.split(" ").some(e=>""!==e&&(c.toLowerCase().indexOf(e.toLowerCase())>-1||p&&p.toLowerCase().indexOf(e.toLowerCase())>-1)))&&(null!=r?r.appendChild(u):e.wrapper.non_selected.appendChild(u))}if(t.hide_empty_groups){var _=document.getElementsByClassName("item-group");for(l=0;l<_.length;l++)_[l].childElementCount<2&&(_[l].style.display="none")}};return function(n,i){if((i=void 0!==i?i:{}).enable_search=void 0===i.enable_search||i.enable_search,i.search_placeholder=void 0!==i.search_placeholder?i.search_placeholder:"Search...",i.non_selected_header=void 0!==i.non_selected_header?i.non_selected_header:null,i.selected_header=void 0!==i.selected_header?i.selected_header:null,i.limit=void 0!==i.limit?parseInt(i.limit):-1,isNaN(i.limit)&&(i.limit=-1),i.hide_empty_groups=void 0!==i.hide_empty_groups&&i.hide_empty_groups,i.search_multiple_words=void 0!==i.search_multiple_words&&i.search_multiple_words,null==n.dataset.multijs&&"SELECT"==n.nodeName&&n.multiple){n.style.display="none",n.setAttribute("data-multijs",!0);var r=document.createElement("div");if(r.className="multi-wrapper",i.enable_search){var d=document.createElement("input");d.className="search-input",d.type="text",d.setAttribute("placeholder",i.search_placeholder),d.setAttribute("title",i.search_placeholder),d.addEventListener("input",function(){a(n,i)}),r.appendChild(d),r.search=d}var l=document.createElement("div");l.className="non-selected-wrapper";var s=document.createElement("div");s.className="selected-wrapper",r.addEventListener("click",function(e){e.target.getAttribute("multi-index")&&t(n,e,i)}),r.addEventListener("keypress",function(e){var a=32===e.keyCode||13===e.keyCode;e.target.getAttribute("multi-index")&&a&&(e.preventDefault(),t(n,e,i))}),r.appendChild(l),r.appendChild(s),r.non_selected=l,r.selected=s,n.wrapper=r,n.parentNode.insertBefore(r,n.nextSibling);for(var o=0;o<n.options.length;o++){var c=n.options[o];c.setAttribute("data-origin-disabled",c.disabled)}e(n,i),a(n,i),n.addEventListener("change",function(){a(n,i)})}}}();"undefined"!=typeof jQuery&&function(e){e.fn.multi=function(t){return t=void 0!==t?t:{},this.each(function(){var a=e(this);multi(a.get(0),t)})}}(jQuery);